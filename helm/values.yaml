# values.yaml

# Global image registry configuration
global:
  # Set to empty string to use default public registries
  imageRegistry: ""

images:
  rcabench:
    name: opspai/rcabench
    tag: latest
    pullPolicy: Always
  redis:
    name: redis
    tag: "8.0-M02-alpine3.20"
    pullPolicy: IfNotPresent
  mysql:
    name: mysql
    tag: "8.0.43"
    pullPolicy: IfNotPresent
  jaeger:
    name: jaegertracing/all-in-one
    tag: latest
    pullPolicy: IfNotPresent
  busybox:
    name: busybox
    tag: "1.35"
    pullPolicy: IfNotPresent
  buildkit:
    name: moby/buildkit
    tag: buildx-stable-1
    pullPolicy: IfNotPresent
  init_data:
    name: init-data
    tag: latest
    pullPolicy: IfNotPresent

harbor:
  enabled: true
  registry: "10.10.10.240"
  namespace: "library"
  username: "admin"
  password: "Harbor12345"

# Initialization settings for PVC setup during install/upgrade
initialization:
  enabled: true

configmap:
  name: "rcabench"
  version: "0.1.0"
  port: 8080
  workspace: "/app"
  system:
    env_mode: "prod"
    timezone: "Asia/Shanghai"
  initialization:
    data_path: "/app/data/initial_data"
  injection:
    target_label_key: "app"
    namespace_config:
      ts:
        count: 2
  database:
    clickhouse:
      host: "10.10.10.58"
      port: "8123"
      user: "default"
      password: "password"
      db: "default"
      timezone: "Asia/Shanghai"
    mysql:
      user: "root"
      port: "3306"
      password: "yourpassword"
      db: "rcabench"
  k8s:
    namespace: "exp"
    init_container:
      busybox_image: "busybox:1.35"
    job:
      volume_mount:
        dataset:
          name: "dataset"
          mount_path: "/data"
          source_type: "pvc"
          claim_name: "rcabench-juicefs-dataset"
        experiment_storage:
          name: "experiment-storage"
          mount_path: "/experiment_storage"
          source_type: "pvc"
          claim_name: "rcabench-juicefs-experiment-storage"
  logging:
    dir: "/app/logs"
    job:
      dir: "jobs"
      log_retention_days: 7
  jfs:
    dataset_path: "/var/lib/rcabench/dataset"
    experiment_storage_path: "/var/lib/rcabench/experiment_storage"
  algo:
    detector: "detector"
  container:
    storage_path: "/app/containers"
  debugging:
    enabled: true
  rate_limiting:
    max_concurrent_builds: 3
    max_concurrent_restarts: 2
    max_concurrent_algo_execution: 5
    token_wait_timeout: 10

persistence:
  # Global storage type setting - applies to containers, logs, and juicefs sections
  # Options: "juicefs" | "volcengine" | "external"
  storageType: "juicefs"
  
  # Common StorageClass names for each type
  storageClassNames:
    juicefs: "juicefs-sc"
    volcengine: "rcabench"
    external: ""
  
  redis:
    enabled: true
    accessMode: ReadWriteOnce
    size: 1Gi
    storageClass: "openebs-hostpath"
  mysql:
    enabled: true
    accessMode: ReadWriteOnce
    size: 1Gi
    storageClass: "openebs-hostpath"
  jaeger:
    enabled: true
    accessMode: ReadWriteOnce
    size: 2Gi
    storageClass: "openebs-hostpath"
  containers:
    enabled: true
    accessMode: ReadWriteMany
    size: 20Gi
    # storageClass is determined by persistence.storageType
  logs:
    enabled: true
    accessMode: ReadWriteMany
    size: 20Gi
    # storageClass is determined by persistence.storageType
  juicefs:
    enabled: true
    size: 1000Gi
    # Uses persistence.storageType for storage selection
    useStaticPV: true  # Only applies when storageType is "juicefs"
    subPath:
      dataset: "rcabench_dataset"
      experiment_storage: "experiment_storage"
    # Volcengine-specific settings (NAS supports ReadWriteMany)
    volcengine:
      accessMode: ReadWriteMany
    # External-specific settings
    external:
      accessMode: ReadWriteMany

# JuiceFS Configuration
juicefs:
  name: "jfs"
  metaurl: "redis://10.10.10.119:6379/1"
  cacheSize: "1024"
  # Optional: configure object storage if needed
  # storage: "s3"
  # bucket: "your-bucket"
  # accessKey: "your-access-key"
  # secretKey: "your-secret-key"
