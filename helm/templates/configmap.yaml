apiVersion: v1
kind: ConfigMap
metadata:
  name: rcabench-config
data:
  config.prod.toml: |
    name = {{ .Values.configmap.name }}
    version = {{ .Values.configmap.version }}
    port = {{ .Values.configmap.port }}
    debug = {{ .Values.configmap.debug }}
    workspace = "{{ .Values.configmap.workspace }}"

    [system]
    timezone = "{{ .Values.configmap.system.timezone }}"

    [injection]
    restart_service= "{{ .Values.configmap.injection.restart_service }}"
    enable_duplicate = "{{ .Values.configmap.injection.enable_duplicate }}"
    namespace_prefix = "{{ .Values.configmap.injection.namespace_prefix }}"
    target_label_key = "{{ .Values.configmap.injection.target_label_key }}"
    target_namespace_count = "{{ .Values.configmap.injection.target_namespace_count }}"
    command= "{{ .Values.configmap.injection.command }}"

    [database]
    clickhouse_host = "{{ .Values.configmap.database.clickhouse_host }}"
    mysql_user = "{{ .Values.configmap.database.mysql_user }}"
    mysql_password = "{{ .Values.configmap.database.mysql_password }}"
    mysql_host = "{{ .Values.configmap.database.mysql_host }}"
    mysql_port = "{{ .Values.configmap.database.mysql_port }}"
    mysql_db = "{{ .Values.configmap.database.mysql_db }}"

    [jaeger]
    endpoint = "{{ .Values.configmap.jaeger.endpoint }}"

    [redis]
    host = "{{ .Values.configmap.redis.host }}"

    [harbor]
    host = "{{ .Values.configmap.harbor.host }}"
    repository = "{{ .Values.configmap.harbor.repository }}"
    username = "{{ .Values.configmap.harbor.username }}"
    password = "{{ .Values.configmap.harbor.password }}"

    [k8s]
    namespace = "{{ .Values.configmap.k8s.namespace }}"

    [nfs]
    path = "{{ .Values.configmap.nfs.path }}"
    pvc_name = "{{ .Values.configmap.nfs.pvc_name }}"

    [algo]
    storage_path = "{{ .Values.configmap.algo.storage_path }}"

    [debugging]
    enable = "{{ .Values.configmap.debugging.enable }}"

    [buildkit]
    address = "{{ .Values.configmap.buildkit.address }}"

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: mariadb-config
data:
  my.cnf: |
    [mysqld]
    bind-address = 0.0.0.0

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: buildkit-config
data:
  buildkitd.toml: |
    debug = true
    trace = false
    insecure-entitlements = ["security.insecure"]

    [grpc]
    address = ["tcp://0.0.0.0:1234"]

    [registry."10.10.10.240"]
    http = false
    ca = ["/usr/local/share/ca-certificates/harbor.lab.pj.crt"]
