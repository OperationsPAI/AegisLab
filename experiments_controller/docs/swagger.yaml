basePath: /api/v1
definitions:
  consts.TaskType:
    enum:
    - RestartService
    - RunAlgorithm
    - FaultInjection
    - BuildImages
    - BuildDataset
    - CollectResult
    type: string
    x-enum-varnames:
    - TaskTypeRestartService
    - TaskTypeRunAlgorithm
    - TaskTypeFaultInjection
    - TaskTypeBuildImages
    - TaskTypeBuildDataset
    - TaskTypeCollectResult
  database.Container:
    properties:
      command:
        description: 启动命令
        type: string
      created_at:
        description: 创建时间
        type: string
      id:
        description: 唯一标识
        type: integer
      image:
        description: 镜像名
        type: string
      name:
        description: 名称
        type: string
      status:
        description: '0: 已删除 1: 活跃'
        type: boolean
      tag:
        description: 镜像标签
        type: string
      type:
        description: 镜像类型
        type: string
      updated_at:
        description: 更新时间
        type: string
    type: object
  database.FaultInjectionSchedule:
    properties:
      benchmark:
        description: 基准数据库
        type: string
      created_at:
        description: 创建时间
        type: string
      description:
        description: 描述（可选字段）
        type: string
      display_config:
        description: 面向用户的展示配置
        type: string
      end_time:
        description: 预计故障结束时间
        type: string
      engine_config:
        description: 面向系统的运行配置
        type: string
      fault_type:
        description: 故障类型
        type: integer
      id:
        description: 唯一标识
        type: integer
      injection_name:
        description: 在k8s资源里注入的名字
        type: string
      labels:
        allOf:
        - $ref: '#/definitions/database.LabelsMap'
        description: 用户自定义标签，JSONB格式存储 key-value pairs
      pre_duration:
        description: 正常数据时间
        type: integer
      start_time:
        description: 预计故障开始时间
        type: string
      status:
        description: '-1: 已删除 0: 初始状态 1: 注入结束且失败 2: 注入结束且成功 3: 收集数据失败 4:收集数据成功'
        type: integer
      task_id:
        description: 从属什么 taskid
        type: string
      updated_at:
        description: 更新时间
        type: string
    type: object
  database.LabelsMap:
    additionalProperties:
      type: string
    type: object
  dto.AlgorithmItem:
    properties:
      image:
        type: string
      name:
        type: string
      tag:
        type: string
    required:
    - name
    type: object
  dto.DatasetBuildPayload:
    properties:
      benchmark:
        type: string
      env_vars:
        type: object
      name:
        type: string
      pre_duration:
        type: integer
    type: object
  dto.DatasetDeleteResp:
    properties:
      failed_names:
        items:
          type: string
        type: array
      success_count:
        type: integer
    type: object
  dto.ExecutionPayload:
    properties:
      algorithm:
        $ref: '#/definitions/dto.AlgorithmItem'
      dataset:
        type: string
      env_vars:
        type: object
    required:
    - algorithm
    - dataset
    type: object
  dto.FaultInjectionNoIssuesResp:
    properties:
      dataset_id:
        type: integer
      display_config:
        type: string
      engine_config:
        $ref: '#/definitions/handler.Node'
      injection_name:
        type: string
      pre_duration:
        type: integer
    type: object
  dto.FaultInjectionStatisticsResp:
    properties:
      no_issues_count:
        type: integer
      total_count:
        type: integer
      with_issues_count:
        type: integer
    type: object
  dto.FaultInjectionWithIssuesResp:
    properties:
      dataset_id:
        type: integer
      display_config:
        type: string
      engine_config:
        $ref: '#/definitions/handler.Node'
      injection_name:
        type: string
      issues:
        type: string
      pre_duration:
        type: integer
    type: object
  dto.GenericResponse-any:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-array_database_FaultInjectionSchedule:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        description: 泛型类型的数据
        items:
          $ref: '#/definitions/database.FaultInjectionSchedule'
        type: array
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-array_dto_FaultInjectionNoIssuesResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        description: 泛型类型的数据
        items:
          $ref: '#/definitions/dto.FaultInjectionNoIssuesResp'
        type: array
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-array_dto_FaultInjectionWithIssuesResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        description: 泛型类型的数据
        items:
          $ref: '#/definitions/dto.FaultInjectionWithIssuesResp'
        type: array
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_DatasetDeleteResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.DatasetDeleteResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_FaultInjectionStatisticsResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.FaultInjectionStatisticsResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_GetCompletedMapResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.GetCompletedMapResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_GroundTruthResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.GroundTruthResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_InjectCancelResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.InjectCancelResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_InjectionFieldMappingResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.InjectionFieldMappingResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_ListAlgorithmsResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        description: 泛型类型的数据
        items:
          $ref: '#/definitions/database.Container'
        type: array
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_NsResourcesResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.NsResourcesResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_PaginationResp-dto_TaskItem:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.PaginationResp-dto_TaskItem'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_PaginationResp-dto_UnifiedTask:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.PaginationResp-dto_UnifiedTask'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_QueryInjectionResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.QueryInjectionResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_RawDataResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        description: 泛型类型的数据
        items:
          $ref: '#/definitions/dto.RawDataItem'
        type: array
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_SubmitInjectionResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.SubmitInjectionResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_SubmitResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.SubmitResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-dto_TaskDetailResp:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/dto.TaskDetailResp'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-handler_Node:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/handler.Node'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GenericResponse-handler_Resources:
    properties:
      code:
        description: 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/handler.Resources'
        description: 泛型类型的数据
      message:
        description: 响应消息
        type: string
      timestamp:
        description: 响应生成时间
        type: integer
    type: object
  dto.GetCompletedMapResp:
    properties:
      has_anomaly:
        description: 检测到异常的链路ID列表
        items:
          type: string
        type: array
      no_anomaly:
        description: 没有异常的链路ID列表
        items:
          type: string
        type: array
    type: object
  dto.GranularityRecord:
    properties:
      confidence:
        type: number
      level:
        type: string
      rank:
        type: integer
      result:
        type: string
    type: object
  dto.GroundTruthReq:
    properties:
      datasets:
        items:
          type: string
        type: array
    required:
    - datasets
    type: object
  dto.GroundTruthResp:
    additionalProperties:
      $ref: '#/definitions/handler.Groundtruth'
    type: object
  dto.InjectCancelResp:
    type: object
  dto.InjectionFieldMappingResp:
    properties:
      fault_resource:
        type: object
      fault_type:
        type: object
      status:
        type: object
    type: object
  dto.LabelItem:
    properties:
      key:
        enum:
        - env
        - batch
        type: string
      value:
        type: string
    required:
    - key
    - value
    type: object
  dto.NsResourcesResp:
    additionalProperties:
      $ref: '#/definitions/handler.Resources'
    type: object
  dto.PaginationResp-dto_TaskItem:
    properties:
      items:
        items:
          $ref: '#/definitions/dto.TaskItem'
        type: array
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  dto.PaginationResp-dto_UnifiedTask:
    properties:
      items:
        items:
          $ref: '#/definitions/dto.UnifiedTask'
        type: array
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  dto.QueryInjectionResp:
    properties:
      benchmark:
        description: 基准数据库
        type: string
      created_at:
        description: 创建时间
        type: string
      description:
        description: 描述（可选字段）
        type: string
      display_config:
        description: 面向用户的展示配置
        type: string
      end_time:
        description: 预计故障结束时间
        type: string
      engine_config:
        description: 面向系统的运行配置
        type: string
      fault_type:
        description: 故障类型
        type: integer
      ground_truth:
        $ref: '#/definitions/handler.Groundtruth'
      id:
        description: 唯一标识
        type: integer
      injection_name:
        description: 在k8s资源里注入的名字
        type: string
      labels:
        allOf:
        - $ref: '#/definitions/database.LabelsMap'
        description: 用户自定义标签，JSONB格式存储 key-value pairs
      pre_duration:
        description: 正常数据时间
        type: integer
      start_time:
        description: 预计故障开始时间
        type: string
      status:
        description: '-1: 已删除 0: 初始状态 1: 注入结束且失败 2: 注入结束且成功 3: 收集数据失败 4:收集数据成功'
        type: integer
      task_id:
        description: 从属什么 taskid
        type: string
      updated_at:
        description: 更新时间
        type: string
    type: object
  dto.RawDataItem:
    properties:
      algorithm:
        type: string
      dataset:
        type: string
      entries:
        items:
          $ref: '#/definitions/dto.GranularityRecord'
        type: array
      execution_id:
        type: integer
      groundtruth:
        $ref: '#/definitions/handler.Groundtruth'
    type: object
  dto.RawDataReq:
    properties:
      algorithms:
        items:
          type: string
        type: array
      datasets:
        items:
          type: string
        type: array
      execution_ids:
        items:
          type: integer
        type: array
    type: object
  dto.RetryPolicy:
    properties:
      backoff_sec:
        description: Seconds to wait between retries
        type: integer
      max_attempts:
        description: Maximum number of retry attempts
        type: integer
    type: object
  dto.SubmitInjectionReq:
    properties:
      algorithms:
        items:
          $ref: '#/definitions/dto.AlgorithmItem'
        type: array
      benchmark:
        type: string
      interval:
        minimum: 1
        type: integer
      labels:
        items:
          $ref: '#/definitions/dto.LabelItem'
        type: array
      pre_duration:
        minimum: 1
        type: integer
      specs:
        items:
          $ref: '#/definitions/handler.Node'
        type: array
    required:
    - benchmark
    - interval
    - pre_duration
    - specs
    type: object
  dto.SubmitInjectionResp:
    properties:
      duplicated_count:
        type: integer
      group_id:
        type: string
      original_count:
        type: integer
      traces:
        items:
          $ref: '#/definitions/dto.Trace'
        type: array
    type: object
  dto.SubmitResp:
    properties:
      group_id:
        type: string
      traces:
        items:
          $ref: '#/definitions/dto.Trace'
        type: array
    type: object
  dto.TaskDetailResp:
    properties:
      logs:
        items:
          type: string
        type: array
      task:
        $ref: '#/definitions/dto.TaskItem'
    type: object
  dto.TaskItem:
    properties:
      created_at:
        type: string
      id:
        type: string
      payload:
        type: object
      status:
        type: string
      trace_id:
        type: string
      type:
        type: string
    type: object
  dto.Trace:
    properties:
      head_task_id:
        type: string
      index:
        type: integer
      trace_id:
        type: string
    type: object
  dto.UnifiedTask:
    properties:
      cron_expr:
        description: Cron expression for recurring tasks
        type: string
      execute_time:
        description: Unix timestamp for delayed execution
        type: integer
      group_carrier:
        allOf:
        - $ref: '#/definitions/propagation.MapCarrier'
        description: Carrier for group context
      group_id:
        description: ID for grouping tasks
        type: string
      immediate:
        description: Whether to execute immediately
        type: boolean
      payload:
        description: Task-specific data
        type: object
      restart_num:
        description: Number of restarts for the task
        type: integer
      retry_policy:
        allOf:
        - $ref: '#/definitions/dto.RetryPolicy'
        description: Policy for retrying failed tasks
      task_id:
        description: Unique identifier for the task
        type: string
      trace_carrier:
        allOf:
        - $ref: '#/definitions/propagation.MapCarrier'
        description: Carrier for trace context
      trace_id:
        description: ID for tracing related tasks
        type: string
      type:
        allOf:
        - $ref: '#/definitions/consts.TaskType'
        description: Task type (determines how it's processed)
    type: object
  handler.Groundtruth:
    properties:
      container:
        items:
          type: string
        type: array
      function:
        items:
          type: string
        type: array
      metric:
        items:
          type: string
        type: array
      pod:
        items:
          type: string
        type: array
      service:
        items:
          type: string
        type: array
      span:
        items:
          type: string
        type: array
    type: object
  handler.Node:
    properties:
      children:
        additionalProperties:
          $ref: '#/definitions/handler.Node'
        type: object
      description:
        type: string
      name:
        type: string
      range:
        items:
          type: integer
        type: array
      value:
        type: integer
    type: object
  handler.Pair:
    properties:
      source:
        type: string
      target:
        type: string
    type: object
  handler.Resources:
    properties:
      app_labels:
        items:
          type: string
        type: array
      container_names:
        items:
          type: string
        type: array
      database_app_names:
        items:
          type: string
        type: array
      dns_app_names:
        items:
          type: string
        type: array
      http_app_names:
        items:
          type: string
        type: array
      jvm_app_names:
        items:
          type: string
        type: array
      network_pairs:
        items:
          $ref: '#/definitions/handler.Pair'
        type: array
    type: object
  propagation.MapCarrier:
    additionalProperties:
      type: string
    type: object
host: localhost:8080
info:
  contact:
    email: team@rcabench.com
    name: RCABench Team
  description: |-
    RCABench - A comprehensive root cause analysis benchmarking platform for microservices
    This API provides endpoints for managing datasets, algorithms, evaluations, and fault injections
    for root cause analysis in distributed systems and microservices architectures.
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  title: RCABench API
  version: 1.0.1
paths:
  /api/v1/algorithms:
    get:
      description: 获取系统中所有可用的算法列表，包括算法的镜像信息、标签和更新时间。只返回状态为激活的算法容器
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回算法列表
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_ListAlgorithmsResp'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取算法列表
      tags:
      - algorithm
    post:
      description: 批量提交算法执行任务，支持多个算法和数据集的组合执行。系统将为每个执行任务分配唯一的 TraceID 用于跟踪任务状态和结果
      parameters:
      - description: 算法执行请求列表，包含算法名称、数据集和环境变量
        in: body
        name: body
        required: true
        schema:
          items:
            $ref: '#/definitions/dto.ExecutionPayload'
          type: array
      produces:
      - application/json
      responses:
        "202":
          description: 成功提交算法执行任务，返回任务跟踪信息
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_SubmitResp'
        "400":
          description: 请求参数错误，如JSON格式不正确、算法名称或数据集名称无效、环境变量名称不支持等
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 提交算法执行任务
      tags:
      - algorithm
  /api/v1/algorithms/build:
    post:
      consumes:
      - multipart/form-data
      description: 通过上传文件或指定GitHub仓库来构建算法Docker镜像。支持zip和tar.gz格式的文件上传，或从GitHub仓库自动拉取代码进行构建。系统会自动验证必需文件（Dockerfile）并设置执行权限
      parameters:
      - description: 算法名称，用于标识算法，将作为镜像构建的标识符
        in: formData
        name: algorithm
        required: true
        type: string
      - description: Docker镜像名称。支持以下格式：1) image-name（自动添加默认Harbor地址和命名空间）2) namespace/image-name（自动添加默认Harbor地址）
        in: formData
        name: image
        required: true
        type: string
      - default: latest
        description: Docker镜像标签，用于版本控制
        in: formData
        name: tag
        type: string
      - default: bash /entrypoint.sh
        description: Docker镜像启动命令，默认为bash /entrypoint.sh
        in: formData
        name: command
        type: string
      - default: file
        description: 构建源类型，指定算法源码来源
        enum:
        - file
        - github
        in: formData
        name: source_type
        type: string
      - description: 算法源码文件（支持zip或tar.gz格式），当source_type为file时必需，文件大小限制5MB
        in: formData
        name: file
        type: file
      - description: GitHub访问令牌，用于访问私有仓库，公开仓库可不提供
        in: formData
        name: github_token
        type: string
      - description: GitHub仓库地址，格式：owner/repo，当source_type为github时必需
        in: formData
        name: github_repo
        type: string
      - default: main
        description: GitHub分支名，指定要构建的分支
        in: formData
        name: github_branch
        type: string
      - description: GitHub commit哈希值（支持短hash），如果指定commit则忽略branch参数
        in: formData
        name: github_commit
        type: string
      - default: .
        description: 仓库内的子目录路径，如果算法源码不在根目录
        in: formData
        name: github_path
        type: string
      - default: .
        description: Docker构建上下文路径，相对于源码根目录
        in: formData
        name: context_dir
        type: string
      - default: Dockerfile
        description: Dockerfile路径，相对于源码根目录
        in: formData
        name: dockerfile_path
        type: string
      - description: Dockerfile构建目标（multi-stage build时使用）
        in: formData
        name: target
        type: string
      - default: false
        description: 是否强制重新构建镜像，忽略缓存
        in: formData
        name: force_rebuild
        type: boolean
      produces:
      - application/json
      responses:
        "202":
          description: 成功提交算法构建任务，返回任务跟踪信息
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_SubmitResp'
        "400":
          description: 请求参数错误：文件格式不支持（仅支持zip、tar.gz）、文件大小超限（5MB）、参数验证失败、GitHub仓库地址无效、force_rebuild值格式错误等
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "404":
          description: 资源不存在：构建上下文路径不存在、缺少必需文件（Dockerfile、entrypoint.sh）
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 提交算法构建任务
      tags:
      - algorithm
  /api/v1/datasets:
    delete:
      description: 删除数据集数据
      parameters:
      - collectionFormat: csv
        description: 数据集名称列表
        in: query
        items:
          type: string
        name: names
        required: true
        type: array
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_DatasetDeleteResp'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 删除数据集数据
      tags:
      - dataset
    post:
      consumes:
      - application/json
      description: 根据指定的时间范围和基准测试容器批量构建数据集。
      parameters:
      - description: 数据集构建请求列表，每个请求包含数据集名称、时间范围、基准测试和环境变量配置
        in: body
        name: body
        required: true
        schema:
          items:
            $ref: '#/definitions/dto.DatasetBuildPayload'
          type: array
      produces:
      - application/json
      responses:
        "202":
          description: 成功提交数据集构建任务，返回任务组ID和跟踪信息列表
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_SubmitResp'
        "400":
          description: 请求参数错误：1) JSON格式不正确 2) 数据集名称为空 3) 时间范围无效 4) 基准测试不存在 5) 环境变量名称不支持
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 批量构建数据集
      tags:
      - dataset
  /api/v1/datasets/download:
    get:
      description: 将指定的多个数据集打包为 ZIP 文件下载，自动排除 result.csv 和检测器结论文件。支持按组ID或数据集名称进行下载，两种方式二选一。下载文件结构：按组ID下载时为
        datasets/{groupId}/{datasetName}/...，按名称下载时为 datasets/{datasetName}/...
      parameters:
      - collectionFormat: csv
        description: 任务组ID列表，格式：group1,group2,group3。与names参数二选一，优先使用group_ids
        in: query
        items:
          type: string
        name: group_ids
        type: array
      - collectionFormat: csv
        description: 数据集名称列表，格式：dataset1,dataset2,dataset3。与group_ids参数二选一
        in: query
        items:
          type: string
        name: names
        type: array
      produces:
      - application/zip
      responses:
        "200":
          description: ZIP 文件流，Content-Disposition 头中包含文件名 datasets.zip
          schema:
            type: string
        "400":
          description: 请求参数错误：1) 参数绑定失败 2) 两个参数都为空 3) 同时提供两种参数
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "403":
          description: 权限错误：请求访问的数据集路径不在系统允许的范围内
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 下载数据集打包文件
      tags:
      - dataset
  /api/v1/debug/ns/status:
    get:
      description: 获取命名空间锁状态信息
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取命名空间锁状态
      tags:
      - debug
  /api/v1/evaluations/groundtruth:
    post:
      description: 根据数据集数组获取对应的 ground truth 数据，用于算法评估的基准数据。支持批量查询多个数据集的真实标签信息
      parameters:
      - description: Ground truth查询请求，包含数据集列表
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/dto.GroundTruthReq'
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回数据集的ground truth信息
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_GroundTruthResp'
        "400":
          description: 请求参数错误，如JSON格式不正确、数据集数组为空
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取数据集的 ground truth
      tags:
      - evaluation
  /api/v1/evaluations/raw-data:
    post:
      description: 根据算法和数据集的笛卡尔积获取对应的原始评估数据，包括粒度记录和真实值信息。支持批量查询多个算法在多个数据集上的执行结果
      parameters:
      - description: 原始数据查询请求，包含算法列表和数据集列表
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/dto.RawDataReq'
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回原始评估数据列表
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_RawDataResp'
        "400":
          description: 请求参数错误，如JSON格式不正确、算法或数据集数组为空
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取原始评估数据
      tags:
      - evaluation
  /api/v1/injections:
    get:
      description: 支持排序、过滤的故障注入记录查询接口。返回数据库原始记录列表，不进行数据转换。
      parameters:
      - description: 环境标签过滤
        in: query
        name: env
        type: string
      - description: 批次标签过滤
        in: query
        name: batch
        type: string
      - description: 基准测试类型过滤
        enum:
        - clickhouse
        in: query
        name: benchmark
        type: string
      - default: 0
        description: 状态过滤，具体值参考字段映射接口(/mapping)
        in: query
        name: status
        type: integer
      - default: 0
        description: 故障类型过滤，具体值参考字段映射接口(/mapping)
        in: query
        name: fault_type
        type: integer
      - default: desc
        description: 排序方式，默认desc。按created_at字段排序
        enum:
        - asc
        - desc
        in: query
        name: sort
        type: string
      - description: 结果数量限制，用于控制返回记录数量
        in: query
        minimum: 1
        name: limit
        type: integer
      - description: 时间范围查询，支持自定义相对时间(1h/24h/7d)或custom 默认不设置
        in: query
        name: lookback
        type: string
      - description: 自定义开始时间，RFC3339格式，当lookback=custom时必需
        format: date-time
        in: query
        name: custom_start_time
        type: string
      - description: 自定义结束时间，RFC3339格式，当lookback=custom时必需
        format: date-time
        in: query
        name: custom_end_time
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回故障注入记录列表
          schema:
            $ref: '#/definitions/dto.GenericResponse-array_database_FaultInjectionSchedule'
        "400":
          description: 请求参数错误，如参数格式不正确、验证失败等
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取故障注入记录列表
      tags:
      - injection
    post:
      description: 提交故障注入任务，支持批量提交多个故障配置，系统会自动去重并返回提交结果
      parameters:
      - description: 故障注入请求体
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/dto.SubmitInjectionReq'
      produces:
      - application/json
      responses:
        "202":
          description: 成功提交故障注入任务
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_SubmitInjectionResp'
        "400":
          description: 请求参数错误，如JSON格式不正确、参数验证失败或算法无效等
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 提交故障注入任务
      tags:
      - injection
  /api/v1/injections/{task_id}/cancel:
    put:
      description: 取消指定的故障注入任务
      parameters:
      - description: 任务ID
        in: path
        name: task_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_InjectCancelResp'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 取消故障注入任务
      tags:
      - injection
  /api/v1/injections/analysis/no-issues:
    get:
      description: 根据时间范围查询所有没有问题的故障注入记录列表，返回包含配置信息的详细记录
      parameters:
      - description: 环境标签过滤
        in: query
        name: env
        type: string
      - description: 批次标签过滤
        in: query
        name: batch
        type: string
      - description: 时间范围查询，支持自定义相对时间(1h/24h/7d)或custom 默认不设置
        in: query
        name: lookback
        type: string
      - description: 自定义开始时间，RFC3339格式，当lookback=custom时必需
        format: date-time
        in: query
        name: custom_start_time
        type: string
      - description: 自定义结束时间，RFC3339格式，当lookback=custom时必需
        format: date-time
        in: query
        name: custom_end_time
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回没有问题的故障注入记录列表
          schema:
            $ref: '#/definitions/dto.GenericResponse-array_dto_FaultInjectionNoIssuesResp'
        "400":
          description: 请求参数错误，如时间格式不正确或参数验证失败等
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 查询没有问题的故障注入记录
      tags:
      - injection
  /api/v1/injections/analysis/statistics:
    get:
      description: 获取故障注入记录的统计信息，包括有问题、没有问题和总记录数量
      parameters:
      - description: 时间范围查询，支持自定义相对时间(1h/24h/7d)或custom 默认不设置
        in: query
        name: lookback
        type: string
      - description: 自定义开始时间，RFC3339格式，当lookback=custom时必需
        format: date-time
        in: query
        name: custom_start_time
        type: string
      - description: 自定义结束时间，RFC3339格式，当lookback=custom时必需
        format: date-time
        in: query
        name: custom_end_time
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回故障注入统计信息
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_FaultInjectionStatisticsResp'
        "400":
          description: 请求参数错误，如时间格式不正确或参数验证失败等
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取故障注入统计信息
      tags:
      - injection
  /api/v1/injections/analysis/with-issues:
    get:
      description: 根据时间范围查询所有有问题的故障注入记录列表
      parameters:
      - description: 环境标签过滤
        in: query
        name: env
        type: string
      - description: 批次标签过滤
        in: query
        name: batch
        type: string
      - description: 时间范围查询，支持自定义相对时间(1h/24h/7d)或custom 默认不设置
        in: query
        name: lookback
        type: string
      - description: 自定义开始时间，RFC3339格式，当lookback=custom时必需
        format: date-time
        in: query
        name: custom_start_time
        type: string
      - description: 自定义结束时间，RFC3339格式，当lookback=custom时必需
        format: date-time
        in: query
        name: custom_end_time
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.GenericResponse-array_dto_FaultInjectionWithIssuesResp'
        "400":
          description: 请求参数错误，如时间格式不正确或参数验证失败等
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 查询有问题的故障注入记录
      tags:
      - injection
  /api/v1/injections/conf:
    get:
      description: 获取指定命名空间的故障注入配置信息，支持不同显示模式的配置树结构
      parameters:
      - description: 命名空间，指定要获取配置的命名空间
        in: query
        name: namespace
        required: true
        type: string
      - default: engine
        description: 显示模式
        enum:
        - display
        - engine
        in: query
        name: mode
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回配置树结构
          schema:
            $ref: '#/definitions/dto.GenericResponse-handler_Node'
        "400":
          description: 请求参数错误，如命名空间或模式参数缺失
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取故障注入配置
      tags:
      - injection
  /api/v1/injections/configs:
    get:
      description: 根据多个TraceID获取对应的故障注入配置信息，用于查看已提交的故障注入任务的配置详情
      parameters:
      - collectionFormat: multi
        description: TraceID列表，支持多个值，用于查询对应的配置信息
        in: query
        items:
          type: string
        name: trace_ids
        type: array
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回配置列表
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "400":
          description: 请求参数错误，如TraceID参数缺失或格式不正确
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取已注入故障配置列表
      tags:
      - injection
  /api/v1/injections/mapping:
    get:
      description: 获取状态和故障类型的字符串与数字映射关系，用于前端显示和API参数验证
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回字段映射关系
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_InjectionFieldMappingResp'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取字段映射关系
      tags:
      - injection
  /api/v1/injections/ns-resources:
    get:
      description: 获取所有命名空间及其对应的资源信息映射，或查询指定命名空间的资源信息。返回命名空间到资源的映射表，用于故障注入配置和资源管理
      parameters:
      - description: 命名空间名称，不指定时返回所有命名空间的资源映射
        in: query
        name: namespace
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 指定命名空间时返回该命名空间的资源信息
          schema:
            $ref: '#/definitions/dto.GenericResponse-handler_Resources'
        "404":
          description: 指定的命名空间不存在
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误，无法获取资源映射
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取命名空间资源映射
      tags:
      - injection
  /api/v1/injections/query:
    get:
      description: 根据名称或任务ID查询故障注入记录详情，两个参数至少提供一个
      parameters:
      - description: 故障注入名称
        in: query
        name: name
        type: string
      - description: 任务ID
        in: query
        name: task_id
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回故障注入记录详情
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_QueryInjectionResp'
        "400":
          description: 请求参数错误，如参数缺失、格式不正确或验证失败等
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 查询单个故障注入记录
      tags:
      - injection
  /api/v1/tasks/{task_id}:
    get:
      description: 根据任务ID获取任务详细信息,包括任务基本信息和执行日志
      parameters:
      - description: 任务ID
        in: path
        name: task_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_TaskDetailResp'
        "400":
          description: 无效的任务ID
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "404":
          description: 任务不存在
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取任务详情
      tags:
      - task
  /api/v1/tasks/list:
    get:
      description: 分页获取任务列表
      parameters:
      - default: 1
        description: 页码
        in: query
        name: page_num
        type: integer
      - default: 10
        description: 每页大小
        in: query
        name: page_size
        type: integer
      - description: 排序字段
        in: query
        name: sort_field
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_PaginationResp-dto_TaskItem'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取任务列表
      tags:
      - task
  /api/v1/tasks/queue:
    get:
      description: 分页获取队列中等待执行的任务列表
      parameters:
      - default: 1
        description: 页码
        in: query
        name: page_num
        type: integer
      - default: 10
        description: 每页大小
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_PaginationResp-dto_UnifiedTask'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取队列中的任务
      tags:
      - task
  /api/v1/traces/analyze:
    get:
      description: 使用多种筛选条件分析链路数据
      parameters:
      - description: 子任务类型筛选
        in: query
        name: first_task_type
        type: string
      - description: 相对时间查询，如 1h, 24h, 7d或者是custom
        in: query
        name: lookback
        type: string
      - description: 当lookback=custom时必需，自定义开始时间(RFC3339格式)
        in: query
        name: custom_start_time
        type: string
      - description: 当lookback=custom时必需，自定义结束时间(RFC3339格式)
        in: query
        name: custom_end_time
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 分析链路数据
      tags:
      - trace
  /api/v1/traces/completed:
    get:
      description: 根据指定的时间范围获取完成状态的链路
      parameters:
      - description: 相对时间查询，如 1h, 24h, 7d或者是custom
        in: query
        name: lookback
        type: string
      - description: 当lookback=custom时必需，自定义开始时间(RFC3339格式)
        in: query
        name: custom_start_time
        type: string
      - description: 当lookback=custom时必需，自定义结束时间(RFC3339格式)
        in: query
        name: custom_end_time
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.GenericResponse-dto_GetCompletedMapResp'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.GenericResponse-any'
      summary: 获取完成状态的链路
      tags:
      - trace
produces:
- application/json
schemes:
- http
- https
swagger: "2.0"
